{"ast":null,"code":"/** @format */\nimport { put, takeLatest, call, all } from 'redux-saga/effects';\nimport { getCurrentUser, googleSignIn, createDataBaseForUser } from '../../firabase/fireBaseUtils';\nimport userActionsTypes from './user.action.types';\nimport { googleSignInFails, googleSignInSuccess, isUserAuthenticateSuccess } from './user.action';\n\nfunction* signInWithGoogle() {\n  try {\n    const {\n      user\n    } = yield call(googleSignIn);\n    const userRef = yield call(createDataBaseForUser, user);\n    const userSnaphot = yield userRef.get();\n    yield put(googleSignInSuccess({\n      id: userSnaphot.id,\n      ...userSnaphot.data()\n    }));\n  } catch (error) {\n    yield put(googleSignInFails(error));\n  }\n}\n\nexport function* onGoogleSignInStart() {\n  yield takeLatest(userActionsTypes.GOOGLE_SIGN_IN_START, signInWithGoogle);\n}\n\nfunction* isUserAuthenticated() {\n  try {\n    const userAuth = yield getCurrentUser();\n    if (!userAuth) return;\n    const userRef = yield call(createDataBaseForUser, userAuth);\n    const userSnaphot = yield userRef.get();\n    yield put(isUserAuthenticateSuccess({\n      id: userSnaphot.id,\n      displayName: userSnaphot.data().displayName,\n      email: userSnaphot.data().email\n    }));\n  } catch (error) {}\n}\n\nexport function* onUserCheck() {\n  yield takeLatest(userActionsTypes.CHECK_USER, isUserAuthenticated);\n}\nexport function* userSagas() {\n  yield all([call(onGoogleSignInStart), call(onUserCheck)]);\n}","map":{"version":3,"sources":["C:/Users/admin/Desktop/crown-with TypeScript/crown/src/redux/user/user.sagas.js"],"names":["put","takeLatest","call","all","getCurrentUser","googleSignIn","createDataBaseForUser","userActionsTypes","googleSignInFails","googleSignInSuccess","isUserAuthenticateSuccess","signInWithGoogle","user","userRef","userSnaphot","get","id","data","error","onGoogleSignInStart","GOOGLE_SIGN_IN_START","isUserAuthenticated","userAuth","displayName","email","onUserCheck","CHECK_USER","userSagas"],"mappings":"AAAA;AAEA,SAASA,GAAT,EAAcC,UAAd,EAA0BC,IAA1B,EAAgCC,GAAhC,QAA2C,oBAA3C;AAEA,SACCC,cADD,EAECC,YAFD,EAGCC,qBAHD,QAIO,8BAJP;AAMA,OAAOC,gBAAP,MAA6B,qBAA7B;AAEA,SACCC,iBADD,EAECC,mBAFD,EAGCC,yBAHD,QAIO,eAJP;;AAMA,UAAUC,gBAAV,GAA6B;AAC5B,MAAI;AACH,UAAM;AAAEC,MAAAA;AAAF,QAAW,MAAMV,IAAI,CAACG,YAAD,CAA3B;AACA,UAAMQ,OAAO,GAAG,MAAMX,IAAI,CAACI,qBAAD,EAAwBM,IAAxB,CAA1B;AACA,UAAME,WAAW,GAAG,MAAMD,OAAO,CAACE,GAAR,EAA1B;AACA,UAAMf,GAAG,CACRS,mBAAmB,CAAC;AAAEO,MAAAA,EAAE,EAAEF,WAAW,CAACE,EAAlB;AAAsB,SAAGF,WAAW,CAACG,IAAZ;AAAzB,KAAD,CADX,CAAT;AAGA,GAPD,CAOE,OAAOC,KAAP,EAAc;AACf,UAAMlB,GAAG,CAACQ,iBAAiB,CAACU,KAAD,CAAlB,CAAT;AACA;AACD;;AAED,OAAO,UAAUC,mBAAV,GAAgC;AACtC,QAAMlB,UAAU,CAACM,gBAAgB,CAACa,oBAAlB,EAAwCT,gBAAxC,CAAhB;AACA;;AAED,UAAUU,mBAAV,GAAgC;AAC/B,MAAI;AACH,UAAMC,QAAQ,GAAG,MAAMlB,cAAc,EAArC;AACA,QAAI,CAACkB,QAAL,EAAe;AACf,UAAMT,OAAO,GAAG,MAAMX,IAAI,CAACI,qBAAD,EAAwBgB,QAAxB,CAA1B;AACA,UAAMR,WAAW,GAAG,MAAMD,OAAO,CAACE,GAAR,EAA1B;AACA,UAAMf,GAAG,CACRU,yBAAyB,CAAC;AACzBM,MAAAA,EAAE,EAAEF,WAAW,CAACE,EADS;AAEzBO,MAAAA,WAAW,EAAET,WAAW,CAACG,IAAZ,GAAmBM,WAFP;AAGzBC,MAAAA,KAAK,EAAEV,WAAW,CAACG,IAAZ,GAAmBO;AAHD,KAAD,CADjB,CAAT;AAOA,GAZD,CAYE,OAAON,KAAP,EAAc,CAAE;AAClB;;AAED,OAAO,UAAUO,WAAV,GAAwB;AAC9B,QAAMxB,UAAU,CAACM,gBAAgB,CAACmB,UAAlB,EAA8BL,mBAA9B,CAAhB;AACA;AAED,OAAO,UAAUM,SAAV,GAAsB;AAC5B,QAAMxB,GAAG,CAAC,CAACD,IAAI,CAACiB,mBAAD,CAAL,EAA4BjB,IAAI,CAACuB,WAAD,CAAhC,CAAD,CAAT;AACA","sourcesContent":["/** @format */\r\n\r\nimport { put, takeLatest, call, all } from 'redux-saga/effects';\r\n\r\nimport {\r\n\tgetCurrentUser,\r\n\tgoogleSignIn,\r\n\tcreateDataBaseForUser,\r\n} from '../../firabase/fireBaseUtils';\r\n\r\nimport userActionsTypes from './user.action.types';\r\n\r\nimport {\r\n\tgoogleSignInFails,\r\n\tgoogleSignInSuccess,\r\n\tisUserAuthenticateSuccess,\r\n} from './user.action';\r\n\r\nfunction* signInWithGoogle() {\r\n\ttry {\r\n\t\tconst { user } = yield call(googleSignIn);\r\n\t\tconst userRef = yield call(createDataBaseForUser, user);\r\n\t\tconst userSnaphot = yield userRef.get();\r\n\t\tyield put(\r\n\t\t\tgoogleSignInSuccess({ id: userSnaphot.id, ...userSnaphot.data() }),\r\n\t\t);\r\n\t} catch (error) {\r\n\t\tyield put(googleSignInFails(error));\r\n\t}\r\n}\r\n\r\nexport function* onGoogleSignInStart() {\r\n\tyield takeLatest(userActionsTypes.GOOGLE_SIGN_IN_START, signInWithGoogle);\r\n}\r\n\r\nfunction* isUserAuthenticated() {\r\n\ttry {\r\n\t\tconst userAuth = yield getCurrentUser();\r\n\t\tif (!userAuth) return;\r\n\t\tconst userRef = yield call(createDataBaseForUser, userAuth);\r\n\t\tconst userSnaphot = yield userRef.get();\r\n\t\tyield put(\r\n\t\t\tisUserAuthenticateSuccess({\r\n\t\t\t\tid: userSnaphot.id,\r\n\t\t\t\tdisplayName: userSnaphot.data().displayName,\r\n\t\t\t\temail: userSnaphot.data().email,\r\n\t\t\t}),\r\n\t\t);\r\n\t} catch (error) {}\r\n}\r\n\r\nexport function* onUserCheck() {\r\n\tyield takeLatest(userActionsTypes.CHECK_USER, isUserAuthenticated);\r\n}\r\n\r\nexport function* userSagas() {\r\n\tyield all([call(onGoogleSignInStart), call(onUserCheck)]);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}